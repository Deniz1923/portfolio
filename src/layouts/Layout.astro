---
import '../styles/global.css';
import '@fontsource/inter/300.css';
import '@fontsource/inter/400.css';
import '@fontsource/inter/500.css';
import '@fontsource/inter/600.css';
import '@fontsource/inter/700.css';
import '@fontsource/inter/800.css';

interface Props {
  title: string;
  description?: string;
  image?: string;
  url?: string;
}

const {
  title,
  description = "Computer Engineering Student | Developer | Problem Solver",
  image = "/favicon.svg",
  url = Astro.url.href
} = Astro.props;
---

<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="description" content={description} />
    <meta name="author" content="Deniz" />
    
    <!-- Favicon -->
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
    
    <!-- Open Graph / Social -->
    <meta property="og:type" content="website" />
    <meta property="og:url" content={url} />
    <meta property="og:title" content={title} />
    <meta property="og:description" content={description} />
    <meta property="og:image" content={image} />
    
    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content={title} />
    <meta name="twitter:description" content={description} />
    <meta name="twitter:image" content={image} />
    
    <title>{title}</title>
    
    <!-- Theme initialization (prevent flash) -->
    <script is:inline>
      const saved = localStorage.getItem('theme');
      const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
      document.documentElement.setAttribute('data-theme', saved || (prefersDark ? 'dark' : 'dark'));
    </script>
  </head>
  
  <body>
    <!-- Navigation -->
    <nav class="fixed top-0 left-0 right-0 z-50 glass border-b border-[var(--color-border)]" style="border-radius: 0;" role="navigation" aria-label="Main navigation">
      <div class="max-w-6xl mx-auto px-6 py-4">
        <div class="flex items-center justify-between">
          <!-- Logo -->
          <a href="#hero" class="text-xl font-bold gradient-text" aria-label="Go to top">
            Deniz
          </a>
          
          <!-- Nav Links -->
          <div class="hidden md:flex items-center gap-8">
            <a href="#about" class="nav-link">About</a>
            <a href="#skills" class="nav-link">Skills</a>
            <a href="#experience" class="nav-link">Experience</a>
            <a href="#projects" class="nav-link">Projects</a>
            <a href="#education" class="nav-link">Education</a>
            <a href="#contact" class="nav-link">Contact</a>
          </div>
          
          <div class="flex items-center gap-3">
            <!-- Theme Toggle -->
            <button id="theme-toggle" class="p-2 rounded-lg border border-[var(--color-border)] hover:border-[var(--color-primary)] transition-all" aria-label="Toggle dark/light mode">
              <svg id="sun-icon" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="hidden">
                <circle cx="12" cy="12" r="5"></circle>
                <line x1="12" y1="1" x2="12" y2="3"></line>
                <line x1="12" y1="21" x2="12" y2="23"></line>
                <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                <line x1="1" y1="12" x2="3" y2="12"></line>
                <line x1="21" y1="12" x2="23" y2="12"></line>
                <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
              </svg>
              <svg id="moon-icon" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
              </svg>
            </button>
            
            <!-- Mobile Menu Button -->
            <button id="mobile-menu-btn" class="md:hidden p-2 text-gray-400 hover:text-white transition" aria-label="Toggle mobile menu" aria-expanded="false">
              <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <line x1="3" y1="6" x2="21" y2="6"></line>
                <line x1="3" y1="12" x2="21" y2="12"></line>
                <line x1="3" y1="18" x2="21" y2="18"></line>
              </svg>
            </button>
          </div>
        </div>
        
        <!-- Mobile Menu -->
        <div id="mobile-menu" class="hidden md:hidden mt-4 pb-4 border-t border-[var(--color-border)] pt-4" role="menu">
          <div class="flex flex-col gap-4">
            <a href="#about" class="nav-link" role="menuitem">About</a>
            <a href="#skills" class="nav-link" role="menuitem">Skills</a>
            <a href="#experience" class="nav-link" role="menuitem">Experience</a>
            <a href="#projects" class="nav-link" role="menuitem">Projects</a>
            <a href="#education" class="nav-link" role="menuitem">Education</a>
            <a href="#contact" class="nav-link" role="menuitem">Contact</a>
          </div>
        </div>
      </div>
    </nav>

    <!-- Main Content -->
    <main role="main">
      <slot />
    </main>

    <!-- Footer -->
    <footer class="border-t border-[var(--color-border)] py-8" role="contentinfo">
      <div class="max-w-6xl mx-auto px-6 text-center">
        <p class="text-[var(--color-text-muted)]">
          Â© 2026 Deniz. Built with 
          <span class="gradient-text">Astro</span> & 
          <span class="gradient-text">Tailwind CSS</span>
        </p>
      </div>
    </footer>

    <!-- Scripts -->
    <script>
      // Mobile menu
      const menuBtn = document.getElementById('mobile-menu-btn');
      const mobileMenu = document.getElementById('mobile-menu');
      
      menuBtn?.addEventListener('click', () => {
        const isOpen = !mobileMenu?.classList.contains('hidden');
        mobileMenu?.classList.toggle('hidden');
        menuBtn?.setAttribute('aria-expanded', String(!isOpen));
      });
      
      mobileMenu?.querySelectorAll('a').forEach(link => {
        link.addEventListener('click', () => {
          mobileMenu?.classList.add('hidden');
          menuBtn?.setAttribute('aria-expanded', 'false');
        });
      });

      // Theme toggle
      const themeToggle = document.getElementById('theme-toggle');
      const sunIcon = document.getElementById('sun-icon');
      const moonIcon = document.getElementById('moon-icon');
      
      function updateIcons() {
        const theme = document.documentElement.getAttribute('data-theme');
        if (theme === 'light') {
          sunIcon?.classList.add('hidden');
          moonIcon?.classList.remove('hidden');
        } else {
          sunIcon?.classList.remove('hidden');
          moonIcon?.classList.add('hidden');
        }
      }
      
      updateIcons();
      
      themeToggle?.addEventListener('click', () => {
        const current = document.documentElement.getAttribute('data-theme');
        const next = current === 'dark' ? 'light' : 'dark';
        document.documentElement.setAttribute('data-theme', next);
        localStorage.setItem('theme', next);
        updateIcons();
      });

      // Scroll-triggered animations
      const prefersReducedMotion = window.matchMedia('(prefers-reduced-motion: reduce)').matches;
      
      if (!prefersReducedMotion) {
        const sections = document.querySelectorAll('.section');
        
        const observer = new IntersectionObserver((entries) => {
          entries.forEach(entry => {
            if (entry.isIntersecting) {
              entry.target.classList.add('in-view');
            }
          });
        }, {
          threshold: 0.1,
          rootMargin: '0px 0px -50px 0px'
        });
        
        sections.forEach(section => observer.observe(section));
      } else {
        // If reduced motion preferred, show everything immediately
        document.querySelectorAll('.section').forEach(s => s.classList.add('in-view'));
      }
    </script>
  </body>
</html>